<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ë©”ë‰´ ê´€ë¦¬</title>
</head>
<body>
  <h1>ğŸ› ï¸ ê´€ë¦¬ì - ë©”ë‰´ ê´€ë¦¬</h1>

  <h2>ğŸ“‹ í˜„ì¬ ë©”ë‰´ ëª©ë¡</h2>
  <ul id="menu-list">
    <li>ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li>
  </ul>

  <h2>â• ë©”ë‰´ ì¶”ê°€í•˜ê¸°</h2>
  <form id="add-menu-form">
    <label>ë©”ë‰´ ì´ë¦„:</label><br>
    <input type="text" id="menu-name" required><br><br>

    <label>ê°€ê²© (â‚©):</label><br>
    <input type="number" id="menu-price" required><br><br>

    <button type="submit">ì¶”ê°€</button>
  </form>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
  import { getFirestore, collection, doc, onSnapshot, getDocs, addDoc, updateDoc, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB5fNlZwwqhutBm-iGGR4SX3HPUY6PR1cU",
    authDomain: "fjocs-57418.firebaseapp.com",
    projectId: "fjocs-57418",
    storageBucket: "fjocs-57418.firebasestorage.app",
    messagingSenderId: "1025344233506",
    appId: "1:1025344233506:web:edcf50e049f8b4ce18aa7b",
    measurementId: "G-059R0SJRLJ"
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);


    const menusRef = collection(db, "menus");
    const menuList = document.getElementById('menu-list');
    const addForm = document.getElementById('add-menu-form');

    async function loadMenus() {
      menuList.innerHTML = "";
      const snapshot = await getDocs(menusRef);
      snapshot.forEach((docSnap) => {
        const data = docSnap.data();
        const li = document.createElement('li');
        li.innerHTML = `
          ${data.name} (â‚©${data.price})
          <button onclick="deleteMenu('${docSnap.id}')">ì‚­ì œ</button>
          <button onclick="editMenu('${docSnap.id}', '${data.name}', ${data.price})">ìˆ˜ì •</button>
        `;
        menuList.appendChild(li);
      });
    }

    // ë©”ë‰´ ì¶”ê°€
    addForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const name = document.getElementById('menu-name').value;
      const price = Number(document.getElementById('menu-price').value);

      await addDoc(menusRef, { name, price });
      alert('ë©”ë‰´ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!');
      addForm.reset();
      loadMenus();
    });

    // ë©”ë‰´ ì‚­ì œ
    window.deleteMenu = async (id) => {
      if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
        await deleteDoc(doc(db, "menus", id));
        alert('ì‚­ì œ ì™„ë£Œ!');
        loadMenus();
      }
    };

    // ë©”ë‰´ ìˆ˜ì •
    window.editMenu = async (id, oldName, oldPrice) => {
      const newName = prompt("ìƒˆ ë©”ë‰´ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”:", oldName);
      const newPrice = prompt("ìƒˆ ê°€ê²©ì„ ì…ë ¥í•˜ì„¸ìš”:", oldPrice);

      if (newName && newPrice) {
        await updateDoc(doc(db, "menus", id), {
          name: newName,
          price: Number(newPrice)
        });
        alert('ìˆ˜ì • ì™„ë£Œ!');
        loadMenus();
      }
    };

    loadMenus();
  </script>

</body>
</html>
